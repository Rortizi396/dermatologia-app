"use strict";(self.webpackChunkdermatologia_app=self.webpackChunkdermatologia_app||[]).push([[843],{9843:(y,p,s)=>{s.r(p),s.d(p,{DoctorPrescriptionsHistoryComponent:()=>O});var l=s(2200),a=s(9417),g=s(8132),e=s(3664),P=s(4796),f=s(3711),h=s(4882);const u=()=>["/doctor/receta"],c=n=>["/doctor/recetas",n],_=()=>({print:1});function F(n,r){1&n&&(e.j41(0,"div"),e.EFF(1,"Cargando..."),e.k0s())}function b(n,r){1&n&&(e.j41(0,"div",23),e.EFF(1,"No has generado recetas a\xfan."),e.k0s())}function v(n,r){if(1&n&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.j41(5,"div",27),e.EFF(6),e.k0s()(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td",28),e.EFF(10),e.k0s(),e.j41(11,"td",29)(12,"a",30),e.EFF(13,"Ver"),e.k0s(),e.j41(14,"a",31),e.EFF(15,"Imprimir"),e.k0s()()()),2&n){const t=r.$implicit,i=e.XpG(2);e.R7$(2),e.JRh(t.fecha),e.R7$(2),e.JRh(i.displayPatient(t.paciente_dpi)),e.R7$(2),e.SpI("DPI: ",t.paciente_dpi),e.R7$(2),e.JRh(t.items.length||0),e.R7$(2),e.JRh(t.observaciones||"\u2014"),e.R7$(2),e.Y8G("routerLink",e.eq3(8,c,t.id)),e.R7$(2),e.Y8G("routerLink",e.eq3(10,c,t.id))("queryParams",e.lJ4(12,_))}}function C(n,r){if(1&n&&(e.j41(0,"div",24)(1,"table",25)(2,"thead")(3,"tr")(4,"th"),e.EFF(5,"Fecha"),e.k0s(),e.j41(6,"th"),e.EFF(7,"Paciente"),e.k0s(),e.j41(8,"th"),e.EFF(9,"\xcdtems"),e.k0s(),e.j41(10,"th"),e.EFF(11,"Observaciones"),e.k0s(),e.nrm(12,"th"),e.k0s()(),e.j41(13,"tbody"),e.DNE(14,v,16,13,"tr",26),e.k0s()()()),2&n){const t=e.XpG();e.R7$(14),e.Y8G("ngForOf",t.misRecetas)}}function E(n,r){if(1&n&&(e.j41(0,"option",32),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.Y8G("ngValue",t.DPI),e.R7$(),e.Lme("",(t.Nombres||t.nombres||"")+" "+(t.Apellidos||t.apellidos||"")," \u2014 DPI: ",t.DPI)}}function D(n,r){1&n&&(e.j41(0,"div",33),e.EFF(1,"Cargando..."),e.k0s())}function k(n,r){1&n&&(e.j41(0,"div",23),e.EFF(1,"Sin recetas para el paciente seleccionado."),e.k0s())}function M(n,r){if(1&n&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",28),e.EFF(6),e.k0s(),e.j41(7,"td",29)(8,"a",30),e.EFF(9,"Ver"),e.k0s(),e.j41(10,"a",31),e.EFF(11,"Imprimir"),e.k0s()()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.fecha),e.R7$(2),e.JRh(t.items.length||0),e.R7$(2),e.JRh(t.observaciones||"\u2014"),e.R7$(2),e.Y8G("routerLink",e.eq3(6,c,t.id)),e.R7$(2),e.Y8G("routerLink",e.eq3(8,c,t.id))("queryParams",e.lJ4(10,_))}}function R(n,r){if(1&n&&(e.j41(0,"div",34)(1,"table",25)(2,"thead")(3,"tr")(4,"th"),e.EFF(5,"Fecha"),e.k0s(),e.j41(6,"th"),e.EFF(7,"\xcdtems"),e.k0s(),e.j41(8,"th"),e.EFF(9,"Observaciones"),e.k0s(),e.nrm(10,"th"),e.k0s()(),e.j41(11,"tbody"),e.DNE(12,M,12,11,"tr",26),e.k0s()()()),2&n){const t=e.XpG();e.R7$(12),e.Y8G("ngForOf",t.recetasPorPaciente)}}let O=(()=>{class n{auth;patientSvc;rxSvc;meCorreo="";meColegiado="";pacientes=[];selectedDPI="";misRecetas=[];recetasPorPaciente=[];loadingSelf=!1;loadingPaciente=!1;constructor(t,i,o){this.auth=t,this.patientSvc=i,this.rxSvc=o}ngOnInit(){const t=this.auth.currentUserValue;this.meCorreo=t?.correo||"",this.meColegiado=t?.colegiado||"",this.patientSvc.list(!1).subscribe(i=>this.pacientes=i||[]),this.loadMine()}loadMine(){this.loadingSelf=!0,this.rxSvc.list({doctor_correo:this.meCorreo||void 0,doctor_colegiado:this.meColegiado||void 0,page:1,limit:100}).subscribe({next:t=>{this.misRecetas=t?.data||[],this.loadingSelf=!1},error:t=>{this.misRecetas=[],this.loadingSelf=!1}})}searchByPaciente(){this.selectedDPI?(this.loadingPaciente=!0,this.rxSvc.list({paciente_dpi:this.selectedDPI,page:1,limit:100}).subscribe({next:t=>{this.recetasPorPaciente=t?.data||[],this.loadingPaciente=!1},error:t=>{this.recetasPorPaciente=[],this.loadingPaciente=!1}})):this.recetasPorPaciente=[]}displayPatient(t){const i=this.pacientes.find(o=>String(o.DPI)===String(t));return i?`${i.Nombres||i.nombres||""} ${i.Apellidos||i.apellidos||""}`.trim():t}static \u0275fac=function(i){return new(i||n)(e.rXU(P.u),e.rXU(f.X),e.rXU(h.q))};static \u0275cmp=e.VBU({type:n,selectors:[["app-doctor-prescriptions-history"]],decls:37,vars:11,consts:[[1,"container-xxl","py-3"],[1,"toolbar","d-flex","align-items-center","justify-content-between","p-2","mb-3","flex-wrap","gap-2"],[1,"m-0"],[1,"d-flex","align-items-center","gap-2"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"row","g-3"],[1,"col-12","col-lg-6"],[1,"card","p-3"],[1,"card-header","pb-2"],[1,"card-body","pt-2"],[4,"ngIf"],["class","text-muted small",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"row","g-2","align-items-end"],[1,"col-12","col-md-8"],[1,"form-label"],[1,"form-control",3,"ngModelChange","change","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-12","col-md-4"],[1,"btn","btn-primary","w-100",3,"click"],["class","mt-3",4,"ngIf"],["class","table-responsive mt-3",4,"ngIf"],[1,"text-muted","small"],[1,"table-responsive"],[1,"table","table-modern"],[4,"ngFor","ngForOf"],[1,"small","text-muted"],[1,"small"],[1,"text-end"],[1,"btn","btn-sm","btn-outline-secondary","me-2",3,"routerLink"],[1,"btn","btn-sm","btn-outline-primary",3,"routerLink","queryParams"],[3,"ngValue"],[1,"mt-3"],[1,"table-responsive","mt-3"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h5",2),e.EFF(3,"Historial de recetas (Doctor)"),e.k0s(),e.j41(4,"div",3)(5,"a",4),e.EFF(6,"Nueva receta"),e.k0s()()(),e.j41(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"strong"),e.EFF(12,"Mis recetas"),e.k0s()(),e.j41(13,"div",9),e.DNE(14,F,2,0,"div",10)(15,b,2,0,"div",11)(16,C,15,1,"div",12),e.k0s()()(),e.j41(17,"div",6)(18,"div",7)(19,"div",8)(20,"strong"),e.EFF(21,"Buscar por paciente"),e.k0s()(),e.j41(22,"div",9)(23,"div",13)(24,"div",14)(25,"label",15),e.EFF(26,"Paciente"),e.k0s(),e.j41(27,"select",16),e.mxI("ngModelChange",function(d){return e.DH7(o.selectedDPI,d)||(o.selectedDPI=d),d}),e.bIt("change",function(){return o.searchByPaciente()}),e.j41(28,"option",17),e.EFF(29,"Seleccione un paciente"),e.k0s(),e.DNE(30,E,2,3,"option",18),e.k0s()(),e.j41(31,"div",19)(32,"button",20),e.bIt("click",function(){return o.searchByPaciente()}),e.EFF(33,"Buscar"),e.k0s()()(),e.DNE(34,D,2,0,"div",21)(35,k,2,0,"div",11)(36,R,13,1,"div",22),e.k0s()()()()()),2&i&&(e.R7$(5),e.Y8G("routerLink",e.lJ4(10,u)),e.R7$(9),e.Y8G("ngIf",o.loadingSelf),e.R7$(),e.Y8G("ngIf",!o.loadingSelf&&0===o.misRecetas.length),e.R7$(),e.Y8G("ngIf",o.misRecetas.length>0),e.R7$(11),e.R50("ngModel",o.selectedDPI),e.R7$(),e.Y8G("ngValue",""),e.R7$(2),e.Y8G("ngForOf",o.pacientes),e.R7$(4),e.Y8G("ngIf",o.loadingPaciente),e.R7$(),e.Y8G("ngIf",!o.loadingPaciente&&0===o.recetasPorPaciente.length&&o.selectedDPI),e.R7$(),e.Y8G("ngIf",o.recetasPorPaciente.length>0))},dependencies:[l.MD,l.Sq,l.bT,a.YN,a.xH,a.y7,a.wz,a.BC,a.vS,g.iI,g.Wk],styles:[".table-modern[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.table-modern[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background:#fff;z-index:1;font-weight:600;border-bottom:1px solid #e5e7eb}.table-modern[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .15s ease}.table-modern[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8fafc}.table-modern[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-modern[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px 12px;vertical-align:top}.table-modern[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] + tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px solid #f1f5f9}.table-modern[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:4px 10px}.card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 6px 18px #0000000f;border:1px solid #eef2f7}.card-header[_ngcontent-%COMP%]{background:transparent;border-bottom:1px solid #eef2f7}"]})}return n})()}}]);