"use strict";(self.webpackChunkdermatologia_app=self.webpackChunkdermatologia_app||[]).push([[843],{9843:(j,p,r)=>{r.r(p),r.d(p,{DoctorPrescriptionsHistoryComponent:()=>y});var l=r(2200),a=r(9417),m=r(8132),e=r(3664),h=r(4796),u=r(3711),P=r(4882);const F=()=>["/doctor/receta"],c=i=>["/doctor/recetas",i],_=()=>({print:1});function f(i,s){1&i&&(e.j41(0,"div"),e.EFF(1,"Cargando..."),e.k0s())}function v(i,s){1&i&&(e.j41(0,"div",23),e.EFF(1,"No has generado recetas a\xfan."),e.k0s())}function E(i,s){if(1&i&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.j41(5,"div",27),e.EFF(6),e.k0s()(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td",28),e.EFF(10),e.k0s(),e.j41(11,"td",29)(12,"a",30),e.EFF(13,"Ver"),e.k0s(),e.j41(14,"a",31),e.EFF(15,"Imprimir"),e.k0s()()()),2&i){const t=s.$implicit,o=e.XpG(2);e.R7$(2),e.JRh(t.fecha),e.R7$(2),e.JRh(o.displayPatient(t.paciente_dpi)),e.R7$(2),e.SpI("DPI: ",t.paciente_dpi),e.R7$(2),e.JRh(t.items.length||0),e.R7$(2),e.JRh(t.observaciones||"\u2014"),e.R7$(2),e.Y8G("routerLink",e.eq3(8,c,t.id)),e.R7$(2),e.Y8G("routerLink",e.eq3(10,c,t.id))("queryParams",e.lJ4(12,_))}}function D(i,s){if(1&i&&(e.j41(0,"div",24)(1,"table",25)(2,"thead")(3,"tr")(4,"th"),e.EFF(5,"Fecha"),e.k0s(),e.j41(6,"th"),e.EFF(7,"Paciente"),e.k0s(),e.j41(8,"th"),e.EFF(9,"\xcdtems"),e.k0s(),e.j41(10,"th"),e.EFF(11,"Observaciones"),e.k0s(),e.nrm(12,"th"),e.k0s()(),e.j41(13,"tbody"),e.DNE(14,E,16,13,"tr",26),e.k0s()()()),2&i){const t=e.XpG();e.R7$(14),e.Y8G("ngForOf",t.misRecetas)}}function R(i,s){if(1&i&&(e.j41(0,"option",32),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("ngValue",t.DPI),e.R7$(),e.Lme("",(t.Nombres||t.nombres||"")+" "+(t.Apellidos||t.apellidos||"")," \u2014 DPI: ",t.DPI)}}function k(i,s){1&i&&(e.j41(0,"div",33),e.EFF(1,"Cargando..."),e.k0s())}function b(i,s){1&i&&(e.j41(0,"div",23),e.EFF(1,"Sin recetas para el paciente seleccionado."),e.k0s())}function C(i,s){if(1&i&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",28),e.EFF(6),e.k0s(),e.j41(7,"td",29)(8,"a",30),e.EFF(9,"Ver"),e.k0s(),e.j41(10,"a",31),e.EFF(11,"Imprimir"),e.k0s()()()),2&i){const t=s.$implicit;e.R7$(2),e.JRh(t.fecha),e.R7$(2),e.JRh(t.items.length||0),e.R7$(2),e.JRh(t.observaciones||"\u2014"),e.R7$(2),e.Y8G("routerLink",e.eq3(6,c,t.id)),e.R7$(2),e.Y8G("routerLink",e.eq3(8,c,t.id))("queryParams",e.lJ4(10,_))}}function I(i,s){if(1&i&&(e.j41(0,"div",34)(1,"table",25)(2,"thead")(3,"tr")(4,"th"),e.EFF(5,"Fecha"),e.k0s(),e.j41(6,"th"),e.EFF(7,"\xcdtems"),e.k0s(),e.j41(8,"th"),e.EFF(9,"Observaciones"),e.k0s(),e.nrm(10,"th"),e.k0s()(),e.j41(11,"tbody"),e.DNE(12,C,12,11,"tr",26),e.k0s()()()),2&i){const t=e.XpG();e.R7$(12),e.Y8G("ngForOf",t.recetasPorPaciente)}}let y=(()=>{class i{auth;patientSvc;rxSvc;meCorreo="";meColegiado="";pacientes=[];selectedDPI="";misRecetas=[];recetasPorPaciente=[];loadingSelf=!1;loadingPaciente=!1;constructor(t,o,n){this.auth=t,this.patientSvc=o,this.rxSvc=n}ngOnInit(){const t=this.auth.currentUserValue;this.meCorreo=t?.correo||"",this.meColegiado=t?.colegiado||"",this.patientSvc.list(!1).subscribe(o=>this.pacientes=o||[]),this.loadMine()}loadMine(){this.loadingSelf=!0,this.rxSvc.list({doctor_correo:this.meCorreo||void 0,doctor_colegiado:this.meColegiado||void 0,page:1,limit:100}).subscribe({next:t=>{this.misRecetas=t?.data||[],this.loadingSelf=!1},error:t=>{this.misRecetas=[],this.loadingSelf=!1}})}searchByPaciente(){this.selectedDPI?(this.loadingPaciente=!0,this.rxSvc.list({paciente_dpi:this.selectedDPI,page:1,limit:100}).subscribe({next:t=>{this.recetasPorPaciente=t?.data||[],this.loadingPaciente=!1},error:t=>{this.recetasPorPaciente=[],this.loadingPaciente=!1}})):this.recetasPorPaciente=[]}displayPatient(t){const o=this.pacientes.find(n=>String(n.DPI)===String(t));return o?`${o.Nombres||o.nombres||""} ${o.Apellidos||o.apellidos||""}`.trim():t}static \u0275fac=function(o){return new(o||i)(e.rXU(h.u),e.rXU(u.X),e.rXU(P.q))};static \u0275cmp=e.VBU({type:i,selectors:[["app-doctor-prescriptions-history"]],decls:37,vars:11,consts:[[1,"container-xxl","py-3"],[1,"toolbar","d-flex","align-items-center","justify-content-between","p-2","mb-3","flex-wrap","gap-2"],[1,"m-0"],[1,"d-flex","align-items-center","gap-2"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"row","g-3"],[1,"col-12","col-lg-6"],[1,"card","p-3"],[1,"card-header","pb-2"],[1,"card-body","pt-2"],[4,"ngIf"],["class","text-muted small",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"row","g-2","align-items-end"],[1,"col-12","col-md-8"],[1,"form-label"],[1,"form-control",3,"ngModelChange","change","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-12","col-md-4"],[1,"btn","btn-primary","w-100",3,"click"],["class","mt-3",4,"ngIf"],["class","table-responsive mt-3",4,"ngIf"],[1,"text-muted","small"],[1,"table-responsive"],[1,"table","table-modern"],[4,"ngFor","ngForOf"],[1,"small","text-muted"],[1,"small"],[1,"text-end"],[1,"btn","btn-sm","btn-outline-secondary","me-2",3,"routerLink"],[1,"btn","btn-sm","btn-outline-primary",3,"routerLink","queryParams"],[3,"ngValue"],[1,"mt-3"],[1,"table-responsive","mt-3"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"h5",2),e.EFF(3,"Historial de recetas (Doctor)"),e.k0s(),e.j41(4,"div",3)(5,"a",4),e.EFF(6,"Nueva receta"),e.k0s()()(),e.j41(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"strong"),e.EFF(12,"Mis recetas"),e.k0s()(),e.j41(13,"div",9),e.DNE(14,f,2,0,"div",10)(15,v,2,0,"div",11)(16,D,15,1,"div",12),e.k0s()()(),e.j41(17,"div",6)(18,"div",7)(19,"div",8)(20,"strong"),e.EFF(21,"Buscar por paciente"),e.k0s()(),e.j41(22,"div",9)(23,"div",13)(24,"div",14)(25,"label",15),e.EFF(26,"Paciente"),e.k0s(),e.j41(27,"select",16),e.mxI("ngModelChange",function(d){return e.DH7(n.selectedDPI,d)||(n.selectedDPI=d),d}),e.bIt("change",function(){return n.searchByPaciente()}),e.j41(28,"option",17),e.EFF(29,"Seleccione un paciente"),e.k0s(),e.DNE(30,R,2,3,"option",18),e.k0s()(),e.j41(31,"div",19)(32,"button",20),e.bIt("click",function(){return n.searchByPaciente()}),e.EFF(33,"Buscar"),e.k0s()()(),e.DNE(34,k,2,0,"div",21)(35,b,2,0,"div",11)(36,I,13,1,"div",22),e.k0s()()()()()),2&o&&(e.R7$(5),e.Y8G("routerLink",e.lJ4(10,F)),e.R7$(9),e.Y8G("ngIf",n.loadingSelf),e.R7$(),e.Y8G("ngIf",!n.loadingSelf&&0===n.misRecetas.length),e.R7$(),e.Y8G("ngIf",n.misRecetas.length>0),e.R7$(11),e.R50("ngModel",n.selectedDPI),e.R7$(),e.Y8G("ngValue",""),e.R7$(2),e.Y8G("ngForOf",n.pacientes),e.R7$(4),e.Y8G("ngIf",n.loadingPaciente),e.R7$(),e.Y8G("ngIf",!n.loadingPaciente&&0===n.recetasPorPaciente.length&&n.selectedDPI),e.R7$(),e.Y8G("ngIf",n.recetasPorPaciente.length>0))},dependencies:[l.MD,l.Sq,l.bT,a.YN,a.xH,a.y7,a.wz,a.BC,a.vS,m.iI,m.Wk],styles:[".table-modern[_ngcontent-%COMP%]{width:100%}.table-modern[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-modern[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top}"]})}return i})()}}]);