<div class="secretary-dashboard container py-3">
  <div class="patient-hero d-flex flex-column align-items-center justify-content-center py-3 mb-3">
    <div class="hero-clock w-100 d-flex justify-content-center">
      <div class="clock-wrapper d-flex align-items-center flex-column flex-sm-row">
        <div class="clock-time">{{ timeString }}</div>
        <div class="clock-date mt-2 mt-sm-0 ms-sm-3">{{ dateString }}</div>
      </div>
    </div>
  </div>

  <div class="mb-3">
    <h4>Reprogramar Cita</h4>
    <div class="small text-muted">Selecciona una cita (estado pendiente o confirmada) y elige nueva fecha y hora.</div>
  </div>

  <div *ngIf="loading" class="mb-3">Cargando citas...</div>

  <div class="appointments-list mb-3">
    <div *ngFor="let c of appointments">
      <div class="appointment-item p-2 mb-2 d-flex align-items-center justify-content-between" [class.disabled]="!isSelectable(c)" (click)="isSelectable(c) ? selectAppointment(c.idCitas || c.idcitas || c.id) : null">
        <div class="appointment-info">
          <div><strong>{{ getDateDisplay(c) }}</strong> - {{ getTimeDisplay(c) }}</div>
          <div class="small text-muted">Paciente: {{ displayPatientName(c) }} • Médico: {{ displayDoctorName(c) }}</div>
          <div class="mt-1">
            <span class="badge specialidad-badge">{{ c.especialidadNombre || c.especialidadnombre || (c.especialidadInfo && c.especialidadInfo.Nombre) || '' }}</span>
          </div>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="selectedApt" [disabled]="!isSelectable(c)" (change)="selectAppointment(c.idCitas || c.idcitas || c.id)" [checked]="selectedAppointmentId===(c.idCitas || c.idcitas || c.id)" />
        </div>
      </div>
    </div>
  </div>


  <div class="reprogram-controls mb-4">
    <div class="row g-2 align-items-center">
      <div class="col-auto">
        <label class="form-label">Nueva fecha</label>
        <input type="date" class="form-control" [(ngModel)]="newDate" (change)="selectedAppointment && updateAvailableTimes(getDoctorIdFromAppointment(selectedAppointment), newDate)" />
      </div>
      <div class="col-auto">
        <label class="form-label">Nuevo horario</label>
        <select class="form-select" [(ngModel)]="newTime" (change)="onTimeChange()">
          <option value="">-- Selecciona --</option>
          <option *ngFor="let t of availableTimes" [value]="t">{{ t }}</option>
        </select>
      </div>
      <div class="col-auto d-flex align-items-end">
        <button class="btn btn-primary" (click)="reschedule()">Reprogramar</button>
      </div>
      <div class="col-12 mt-2">
        <div *ngIf="availabilityChecked" class="small">Estado: <strong [ngClass]="{'text-success': available, 'text-danger': !available}">{{ available ? 'Disponible' : 'Ocupado' }}</strong></div>
      </div>
    </div>
  </div>

  <!-- Mission & Vision cards (same style as patient dashboard) -->
  <div class="pagination-controls mt-3">
    <button class="btn btn-outline-secondary" (click)="prevPage()">Anterior</button>
    <button class="btn btn-outline-secondary" (click)="nextPage()">Siguiente</button>
  </div>
  
  <!-- Mission & Vision cards (moved below pagination) -->
  <div class="mission-vision row g-3 mt-4">
    <div class="col-md-6 mb-3">
      <div class="card p-3">
        <div class="card-header pb-2"><strong>Misión</strong></div>
        <div class="card-body pt-1">
          <p class="mb-0">{{ missionText || 'No definida' }}</p>
        </div>
      </div>
    </div>
    <div class="col-md-6 mb-3">
      <div class="card p-3">
        <div class="card-header pb-2"><strong>Visión</strong></div>
        <div class="card-body pt-1">
          <p class="mb-0">{{ visionText || 'No definida' }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
