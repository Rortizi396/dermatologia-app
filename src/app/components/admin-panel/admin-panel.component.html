<div class="admin-panel d-flex gap-3">
  <aside class="admin-sidebar p-2 d-flex flex-column" aria-label="Menú de administración">
    <h5 class="mb-2">Administración</h5>

    <div class="sidebar-box mt-3" style="flex:1;">
      <div class="list-group">
  <button class="list-group-item list-group-item-action d-flex align-items-center" [class.active]="view==='mission'" (click)="view='mission'">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-2">
            <path d="M12 2L2 7l10 5 10-5-10-5z" />
            <path d="M2 17l10 5 10-5" />
            <path d="M2 12l10 5 10-5" />
          </svg>
          <span>Misión / Visión</span>
        </button>

  <button class="list-group-item list-group-item-action d-flex align-items-center" [class.active]="view==='history'" (click)="view='history'">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-2">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
          <span>Historial de cambios</span>
        </button>
      </div>
    </div>

    <div class="sidebar-footer mt-3"> 
      <!-- espacio reservado para información de usuario / logout si aplica -->
    </div>
  </aside>

  <main class="flex-fill">
    <!-- Toolbar principal -->
    <div class="toolbar d-flex align-items-center justify-content-between p-2 mb-3 flex-wrap gap-2">
      <h5 class="m-0">Panel de Administración</h5>
      <div class="d-flex gap-2">
        <button class="btn btn-outline-success" (click)="loadSettings()">Recargar contenidos</button>
      </div>
    </div>

    <div *ngIf="view==='none'">
      <div class="card p-3">
        <p class="mb-0 text-muted">Seleccione una opción en la barra lateral para editar la Misión/Visión o ver el Historial de cambios.</p>
      </div>
    </div>

    <div *ngIf="view==='mission'">
      <div class="card p-2 mb-3">
        <div class="d-flex align-items-center justify-content-between">
          <h6 class="m-0">Contenido del sitio</h6>
          <div class="d-flex gap-2">
            <button class="btn btn-outline-secondary btn-sm" (click)="loadSettings()">Deshacer cambios</button>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-12 mb-3">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Misión</h5>
              <div class="form-group mb-2">
                <label class="visually-hidden" for="missionText">Misión</label>
                <textarea id="missionText" class="form-control" rows="6" [(ngModel)]="mission" [disabled]="isSavingMission" style="width:100% !important; display:block; box-sizing:border-box; min-height:120px"></textarea>
              </div>
              <div class="d-flex gap-2">
                <button class="btn btn-success btn-compact" (click)="saveMission()" [disabled]="isSavingMission">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4">
                      <polyline points="20 6 9 17 4 12" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                  <span *ngIf="!isSavingMission">Guardar</span>
                  <span *ngIf="isSavingMission">Guardando...</span>
                </button>
                <button class="btn btn-outline-secondary btn-compact" (click)="cancelMission()" [disabled]="isSavingMission">
                  <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4">
                    <line x1="18" y1="6" x2="6" y2="18" stroke-linecap="round" stroke-linejoin="round" />
                    <line x1="6" y1="6" x2="18" y2="18" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                  Cancelar
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 mb-3">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Visión</h5>
              <div class="form-group mb-2">
                <label class="visually-hidden" for="visionText">Visión</label>
                <textarea id="visionText" class="form-control" rows="6" [(ngModel)]="vision" [disabled]="isSavingVision" style="width:100% !important; display:block; box-sizing:border-box; min-height:120px"></textarea>
              </div>
              <div class="d-flex gap-2">
                <button class="btn btn-success btn-compact" (click)="saveVision()" [disabled]="isSavingVision">
                  <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4">
                    <polyline points="20 6 9 17 4 12" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                  <span *ngIf="!isSavingVision">Guardar</span>
                  <span *ngIf="isSavingVision">Guardando...</span>
                </button>
                <button class="btn btn-outline-secondary btn-compact" (click)="cancelVision()" [disabled]="isSavingVision">
                  <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4">
                    <line x1="18" y1="6" x2="6" y2="18" stroke-linecap="round" stroke-linejoin="round" />
                    <line x1="6" y1="6" x2="18" y2="18" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                  Cancelar
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="view==='history'">
      <app-audit-history></app-audit-history>
    </div>
  </main>
</div>
