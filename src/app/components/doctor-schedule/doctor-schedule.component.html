<div class="doctor-schedule">
  <!-- Hero banner (imagen de ejemplo) -->
  <div class="hero-banner mb-3">
  <img src="assets/images/hero-banner.svg?v=20251031" alt="Centro Dermatológico" style="width:100%;height:auto;border-radius:6px;" />
  </div>

  <div class="schedule-header" style="display:flex;align-items:center;gap:16px;">
    <div style="display:flex;flex-direction:column;">
      <h2 style="margin:0;">Agenda de Citas</h2>
    </div>
    <!-- Selector de doctor -->
    <div style="margin-left:auto;display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
      <label for="selDoctor" class="text-muted" style="font-size:.95rem;">Doctor</label>
  <select id="selDoctor" class="form-select" (change)="onDoctorSelectFromEvent($event)" style="min-width:260px;">
        <option [ngValue]="null">Seleccione un doctor…</option>
        <option *ngFor="let d of doctors" [value]="d.Colegiado || d.colegiado || d.id">
          {{ (d.nombres || d.Nombres || '') }} {{ (d.apellidos || d.Apellidos || '') }}
          <ng-container *ngIf="d.colegiado || d.Colegiado"> — {{ d.colegiado || d.Colegiado }}</ng-container>
        </option>
      </select>
    </div>
  </div>

  <div class="calendar-container" *ngIf="selectedDoctorId">
    <mwl-calendar-month-view
      [viewDate]="viewDate"
      [events]="events"
      (eventClicked)="handleEventClick($event.event)"
      [activeDayIsOpen]="true"
    >
    </mwl-calendar-month-view>
  </div>

  <div *ngIf="!selectedDoctorId" class="text-muted" style="margin-top:8px;">
    Selecciona un doctor para cargar el calendario.
  </div>

  <!-- Detalles de la cita debajo del calendario -->
  <div *ngIf="selectedAppointment" class="appointment-details mt-4">
    <div class="card">
      <div class="card-header">
        <h4>{{ selectedAppointment.title }}</h4>
  <span>{{ selectedAppointment.start | date:'fullDate':'':'es' }} {{ selectedAppointment.start | date:'shortTime':'':'es' }}</span>
      </div>
      <div class="card-body">
        <p><strong>Paciente:</strong> {{ selectedAppointment.paciente }}</p>
        <p><strong>Especialidad:</strong> {{ selectedAppointment.especialidad }}</p>
        <p><strong>Detalles:</strong> {{ selectedAppointment.detalles }}</p>
        <p><strong>Teléfono:</strong> {{ selectedAppointment.telefono }}</p>
        <p><strong>Confirmación:</strong>
          <i [ngClass]="selectedAppointment.confirmadoIconClass" class="confirm-icon" aria-hidden="true"></i>
          <span [ngClass]="selectedAppointment.confirmadoClass" aria-label="Estado de confirmación">{{ selectedAppointment.confirmadoLabel }}</span>
        </p>
        <button class="btn btn-danger mt-2" (click)="selectedAppointment = null">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Mover el div de eventos abiertos fuera del contenedor principal -->
</div>
<div role="application" class="cal-open-day-events"></div>
